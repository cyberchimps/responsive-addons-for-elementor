(function($){'use strict';function getRealContainer($scope){if($scope.hasClass('e-con'))return $scope;if($scope.hasClass('elementor-section')){return $scope}
const $innerSection=$scope.closest('.elementor-inner-section');if($innerSection.length){return $innerSection}
const $column=$scope.closest('.elementor-column');if($column.length){return $column}
return $scope}
function getElementSettings($scope){if(!elementorFrontend.isEditMode()){return $scope.data('settings')||{}}
if($scope.data('model-cid')){const modelCID=$scope.data('model-cid');const elementData=elementorFrontend.config.elements?.data?.[modelCID];if(elementData){return elementData.attributes||{}}}
try{return JSON.parse($scope.attr('data-settings')||'{}')}catch(e){return{}}}
function buildEffectsFromSettings(settings){const effects={};if(settings.rae_animations_scrolling_enable!=='yes'){return null}
if(settings.rae_animations_scroll_effects_type==='horizontal_scroll'){const viewport=settings.rae_animations_horizontal_viewport?.sizes||{};effects.translateX={type:'horizontal',direction:settings.rae_animations_horizontal_direction||'to_left',speed:parseFloat(settings.rae_animations_horizontal_speed?.size)||4,start:parseInt(viewport.start)||0,end:parseInt(viewport.end)||100}}
if(settings.rae_animations_scroll_effects_type==='vertical_scroll'){const viewport=settings.rae_animations_vertical_viewport?.sizes||{};effects.translateY={type:'vertical',direction:settings.rae_animations_vertical_direction||'up',speed:parseFloat(settings.rae_animations_vertical_speed?.size)||4,start:parseInt(viewport.start)||0,end:parseInt(viewport.end)||100}}
if(settings.rae_animations_transparency_enable==='yes'){const viewport=settings.rae_animations_transparency_viewport?.sizes||{};effects.opacity={direction:settings.rae_animations_transparency_direction||'fade_in',level:parseFloat(settings.rae_animations_transparency_level?.size)||4,start:parseInt(viewport.start)||0,end:parseInt(viewport.end)||100}}
if(settings.rae_animations_blur_enable==='yes'){const viewport=settings.rae_animations_blur_viewport?.sizes||{};effects.blur={direction:settings.rae_animations_blur_direction||'fade_in',level:parseFloat(settings.rae_animations_blur_level?.size)||4,start:parseInt(viewport.start)||0,end:parseInt(viewport.end)||100}}
if(settings.rae_animations_scale_enable==='yes'){const viewport=settings.rae_animations_scale_viewport?.sizes||{};effects.scale={direction:settings.rae_animations_scale_direction||'scale_up',speed:parseFloat(settings.rae_animations_scale_speed?.size)||4,origin_x:settings.motion_fx_transform_x_anchor_point||'center',origin_y:settings.motion_fx_transform_y_anchor_point||'center',start:parseInt(viewport.start)||0,end:parseInt(viewport.end)||100}}
if(settings.rae_animations_rotate_enable==='yes'){const viewport=settings.rae_animations_rotate_viewport?.sizes||{};effects.rotate={direction:settings.rae_animations_rotate_direction||'to_left',speed:parseFloat(settings.rae_animations_rotate_speed?.size)||4,start:parseInt(viewport.start)||0,end:parseInt(viewport.end)||100}}
return Object.keys(effects).length?effects:null}
const RaelAnimations={init(){this.isEditor=elementorFrontend.isEditMode();this.windowHeight=this.getViewportHeight();this.scrollTop=this.getScrollTop();this.setupListeners();this.scanElements();this.update()},getViewportHeight(){return window.innerHeight},getScrollTop(){if(this.isEditor){const previewFrame=document.querySelector('#elementor-preview-iframe, .elementor-preview-iframe');if(previewFrame&&previewFrame.contentWindow){return previewFrame.contentWindow.pageYOffset||previewFrame.contentDocument?.documentElement.scrollTop||0}
return 0}
return window.pageYOffset||document.documentElement.scrollTop},getDocumentHeight(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)},setupListeners(){if(this.isEditor){const previewFrame=document.querySelector('#elementor-preview-iframe, .elementor-preview-iframe');if(previewFrame&&previewFrame.contentWindow){$(previewFrame.contentWindow).on('scroll',()=>{this.onScroll()});$(previewFrame.contentWindow).on('resize',()=>{this.onResize()})}}else{$(window).on('scroll',()=>{this.onScroll()});$(window).on('resize',()=>{this.onResize()})}
this.rafUpdate=()=>{this.update();this.rafId=requestAnimationFrame(this.rafUpdate)};this.rafId=requestAnimationFrame(this.rafUpdate)},onScroll(){this.scrollTop=this.getScrollTop()},onResize(){this.windowHeight=this.getViewportHeight();this.scanElements()},scanElements(){this.elements=[];document.querySelectorAll('.rael-scroll-effects').forEach(element=>{this.elements.push(element)})},processElement($scope){const $target=getRealContainer($scope);let effectsData=null;let settings={};if(this.isEditor){settings=getElementSettings($scope);this.setupEntranceAnimation($target,settings);const effects=buildEffectsFromSettings(settings);if(!effects){$target.removeClass('rael-scroll-effects');$target.removeAttr('data-rael-scroll-effects');return}
effectsData={effects,relativeTo:settings.rae_animations_effects_relative_to||'viewport'};$target.addClass('rael-scroll-effects').attr('data-rael-scroll-effects',JSON.stringify(effectsData))}else{const raw=$target.attr('data-rael-scroll-effects');if(!raw)return;try{effectsData=JSON.parse(raw)}catch(e){return}}
if(!effectsData||!effectsData.effects)return;if(!this.elements.includes($target[0])){this.elements.push($target[0])}},setupEntranceAnimation($element,settings){if(settings.rae_animations_entrance&&settings.rae_animations_entrance!=='none'){$element.removeClass('animated rael-animated');$element.removeClass(settings.rae_animations_entrance);$element.addClass('rael-entrance');$element.attr('data-rae-entrance',settings.rae_animations_entrance);const duration=settings.rae_animations_entrance_duration||'1000';$element.attr('data-rae-animation-duration',duration);$element.removeClass('rae-duration-slow rae-duration-normal rae-duration-fast');if(duration==='2000'){$element.addClass('rae-duration-slow')}else if(duration==='1000'){$element.addClass('rae-duration-normal')}else if(duration==='800'){$element.addClass('rae-duration-fast')}
const delay=settings.rae_animations_entrance_animation_delay||'0';$element.attr('data-rae-animation-delay',delay);$element.removeClass('animated');$element[0].__raeEntranceDone=!1}else{$element.removeClass('rael-entrance animated rael-animated');$element.removeAttr('data-rae-entrance data-rae-animation-duration data-rae-animation-delay')}},update(){if(this.elements.length){this.elements.forEach(element=>{this.applyEffects(element)})}
this.handleEntranceAnimations()},applyEffects(element){let effectsData;if(this.isEditor){const $scope=$(element);const settings=getElementSettings($scope);const effects=buildEffectsFromSettings(settings);if(!effects){$scope.removeClass('rael-scroll-effects');element.style.removeProperty('--translateX');element.style.removeProperty('--translateY');element.style.removeProperty('--opacity');element.style.removeProperty('--blur');element.style.removeProperty('--scale');element.style.removeProperty('--rotateZ')}
effectsData={effects:effects,relativeTo:settings.rae_animations_effects_relative_to||'viewport'}}else{const rawData=element.getAttribute('data-rael-scroll-effects');if(!rawData)return;try{effectsData=JSON.parse(rawData)}catch(e){return}}
const effects=effectsData.effects;const relativeTo=effectsData.relativeTo||'viewport';if(!effects)return;const progress=this.calculateProgress(element,relativeTo);this.applyEffect(element,'translateX',effects.translateX,progress);this.applyEffect(element,'translateY',effects.translateY,progress);this.applyEffect(element,'opacity',effects.opacity,progress);this.applyEffect(element,'blur',effects.blur,progress);this.applyEffect(element,'scale',effects.scale,progress);this.applyEffect(element,'rotate',effects.rotate,progress);if(!effects.translateX)element.style.removeProperty('--translateX');if(!effects.translateY)element.style.removeProperty('--translateY');if(!effects.opacity)element.style.removeProperty('--opacity');if(!effects.blur)element.style.removeProperty('--blur');if(!effects.scale)element.style.removeProperty('--scale');if(!effects.rotate)element.style.removeProperty('--rotateZ');},calculateProgress(element,relativeTo){const rect=element.getBoundingClientRect();const elementTop=rect.top+this.scrollTop;const elementHeight=rect.height;const elementBottom=elementTop+elementHeight;let progress=0;switch(relativeTo){case 'page':const viewportTop=this.scrollTop;const viewportBottom=this.scrollTop+this.windowHeight;const viewportElementStart=elementTop-this.windowHeight;const viewportElementEnd=elementBottom;const totalVisibleDistance=viewportElementEnd-viewportElementStart;if(totalVisibleDistance<=0){progress=0;break}
if(this.scrollTop<=viewportElementStart){progress=0}else if(this.scrollTop>=viewportElementEnd){progress=1}else{progress=(this.scrollTop-viewportElementStart)/totalVisibleDistance}
break;case 'default':case 'viewport':default:const documentHeight=this.getDocumentHeight();if(documentHeight<=0){progress=0;break}
const elementCenter=(elementTop+elementHeight/2)/documentHeight;const currentScrollProgress=this.scrollTop/documentHeight;const adjustedProgress=Math.max(0,Math.min(1,(currentScrollProgress-(elementCenter-0.5))/1));const stretchFactor=0.8;const startOffset=elementCenter-(stretchFactor/2);const endOffset=elementCenter+(stretchFactor/2);if(currentScrollProgress<=startOffset){progress=0}else if(currentScrollProgress>=endOffset){progress=1}else{progress=(currentScrollProgress-startOffset)/(endOffset-startOffset)}
break}
progress=Math.min(Math.max(progress,0),1);return progress},applyEffect(element,effectType,effectConfig,progress){if(!effectConfig)return;const mappedProgress=this.stabilizeProgress(this.range(progress,effectConfig.start,effectConfig.end));switch(effectType){case 'translateX':this.applyTranslateX(element,effectConfig,mappedProgress);break;case 'translateY':this.applyTranslateY(element,effectConfig,mappedProgress);break;case 'opacity':this.applyOpacity(element,effectConfig,mappedProgress);break;case 'blur':this.applyBlur(element,effectConfig,mappedProgress);break;case 'scale':this.applyScale(element,effectConfig,mappedProgress);break;case 'rotate':this.applyRotate(element,effectConfig,mappedProgress);break}},stabilizeProgress(progress){progress=Math.max(0,Math.min(1,progress));if(progress<0.001)return 0;if(progress>0.999)return 1;return progress},applyTranslateX(element,config,progress){if(!config||typeof config.speed==='undefined')return;const distance=config.speed*60;const centered=(progress-0.5)*2;const dir=config.direction==='to_left'?-1:1;const value=centered*distance*dir;element.style.setProperty('--translateX',`${value}px`)},applyTranslateY(element,config,progress){if(!config||typeof config.speed==='undefined')return;let value=(1-progress)*config.speed*20;if(config.direction==='up'){value=Math.abs(value)}else if(config.direction==='down'){value=-Math.abs(value)}
element.style.setProperty('--translateY',`${value}px`)},applyOpacity(element,config,progress){if(!config)return;let opacity=1;const level=config.level||1;switch(config.direction){case 'fade_in':opacity=progress*level;break;case 'fade_out':opacity=1-(progress*level);break;case 'fade_out_in':if(progress<0.5){opacity=1-(progress*2*level)}else{opacity=(progress-0.5)*2*level}
break;case 'fade_in_out':if(progress<0.5){opacity=progress*2*level}else{opacity=1-((progress-0.5)*2*level)}
break}
opacity=Math.min(Math.max(opacity,0),1);element.style.setProperty('--opacity',opacity)},applyBlur(element,config,progress){if(!config)return;let blur=0;const level=config.level||1;switch(config.direction){case 'fade_in':blur=progress*level*10;break;case 'fade_out':blur=(1-progress)*level*10;break;case 'fade_out_in':if(progress<0.5){blur=progress*2*level*10}else{blur=(1-progress)*2*level*10}
break;case 'fade_in_out':if(progress<0.5){blur=(1-progress*2)*level*10}else{blur=((progress-0.5)*2)*level*10}
break}
element.style.setProperty('--blur',`${blur}px`)},applyScale(element,config,progress){if(!config)return;let scale=1;const speed=config.speed||1;switch(config.direction){case 'scale_up':scale=1+(progress*speed*0.2);break;case 'scale_down':scale=1-(progress*speed*0.2);break;case 'scale_down_up':if(progress<0.5){scale=1-(progress*2*speed*0.2)}else{scale=1-((1-progress)*2*speed*0.2)}
break;case 'scale_up_down':if(progress<0.5){scale=1+(progress*2*speed*0.2)}else{scale=1+((1-progress)*2*speed*0.2)}
break}
scale=Math.max(scale,0.1);element.style.setProperty('--scale',scale);if(config.origin_x&&config.origin_y){element.style.transformOrigin=`${config.origin_x} ${config.origin_y}`}},applyRotate(element,config,progress){if(!config)return;let rotate=progress*config.speed*20;if(config.direction==='to_left'){rotate=-Math.abs(rotate)}else if(config.direction==='to_right'){rotate=Math.abs(rotate)}
element.style.setProperty('--rotateZ',`${rotate}deg`)},range(progress,start,end){const s=start/100;const e=end/100;if(progress<=s)return 0;if(progress>=e)return 1;return(progress-s)/(e-s)},handleEntranceAnimations(){const self=this;document.querySelectorAll('.rael-entrance:not(.animated)').forEach(element=>{const animation=element.getAttribute('data-rae-entrance');if(!animation||animation==='none')return;const rect=element.getBoundingClientRect();const viewportHeight=this.windowHeight;const isInViewport=(rect.top<=viewportHeight&&rect.bottom>=0);if(isInViewport&&!element.__raeEntranceDone){this.triggerEntranceAnimation(element)}})},triggerEntranceAnimation(element){const animation=element.getAttribute('data-rae-entrance');const delay=element.getAttribute('data-rae-animation-delay')||0;const duration=element.getAttribute('data-rae-animation-duration')||'1000';setTimeout(()=>{element.classList.add('animated',animation,'rael-animated');element.style.animationDuration=duration+'ms';element.__raeEntranceDone=!0;const animationDuration=parseInt(duration)+parseInt(delay);setTimeout(()=>{element.classList.remove(animation)},animationDuration)},parseInt(delay))},updateEntranceAnimations(){document.querySelectorAll('.rael-entrance').forEach(element=>{element.classList.remove('animated','rael-animated');const currentAnimation=element.getAttribute('data-rae-entrance');if(currentAnimation){element.classList.remove(currentAnimation)}
element.__raeEntranceDone=!1})},destroy(){if(this.rafId){cancelAnimationFrame(this.rafId)}
$(window).off('scroll resize')}};$(window).on('elementor/frontend/init',function(){RaelAnimations.init();elementorFrontend.hooks.addAction('frontend/element_ready/global',function($scope){RaelAnimations.processElement($scope);RaelAnimations.scanElements()});elementorFrontend.hooks.addAction('frontend/element_ready/section',function($scope){RaelAnimations.processElement($scope)});elementorFrontend.hooks.addAction('frontend/element_ready/container',function($scope){RaelAnimations.processElement($scope)});elementorFrontend.hooks.addAction('frontend/element_ready/column',function($scope){RaelAnimations.processElement($scope)})})})(jQuery)
